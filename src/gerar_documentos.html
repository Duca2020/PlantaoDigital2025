<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
  <title>Template básico</title>
  <!-- Fonte Rawline-->
  <link rel="stylesheet" href="https://cdngovbr-ds.estaleiro.serpro.gov.br/design-system/fonts/rawline/css/rawline.css"/>
  <!-- Fonte Raleway-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:300,400,500,600,700,800,900&amp;display=swap"/>
  <!-- Design System de Governo-->
<<<<<<< HEAD
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@govbr-ds/core/dist/core.min.css" />
=======
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@govbr-ds/core/dist/core.min.css" />
>>>>>>> dd2a6f51bf47c43c1f1280d72115aec7879d7c59
  <!-- Fontawesome-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css"/>
  <!-- jsPDF e jspdf-autotable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
  <!-- SheetJS-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
<div class="template-base">
  <nav class="br-skiplink" role="menubar"><a class="br-item" href="#main-content" role="menuitem" accesskey="1">Ir para o conteúdo <span aria-hidden="true">(1/4)</span> <span aria-hidden="true" class="br-tag text ml-1">1</span></a><a class="br-item" href="#header-navigation" role="menuitem" accesskey="2">Ir para o menu <span aria-hidden="true">(2/4)</span> <span aria-hidden="true" class="br-tag text ml-1">2</span></a><a class="br-item" href="#main-searchbox" role="menuitem" accesskey="3">Ir para a busca <span aria-hidden="true">(3/4)</span> <span aria-hidden="true" class="br-tag text ml-1">3</span></a><a class="br-item" href="#footer" role="menuitem" accesskey="4">Ir para o rodapé <span aria-hidden="true">(4/4)</span> <span aria-hidden="true" class="br-tag text ml-1">4</span></a>
  </nav>
  <header class="br-header mb-4" id="header" data-sticky="data-sticky">
    <div class="container-lg">
      <div class="header-top">
        <div class="header-logo"><img class="brasaoImg" src="" alt="logo"/><span class="br-divider vertical"></span>
          <div class="header-sign">
            <a href="https://pmt.pi.gov.br/" style="color: #1351B4; text-decoration: none; font-size: 20px;" target="_blank">Prefeitura de Teresina</a>
          </div>
        </div>
        <div class="header-actions">
          <div class="header-links dropdown">
            <button class="br-button circle small" type="button" data-toggle="dropdown" aria-label="Abrir Acesso Rápido"><i class="fas fa-ellipsis-v" aria-hidden="true"></i>
            </button>
            <div class="br-list">
              <div class="header">
                <div class="title">Acesso Rápido</div>
              </div><a class="br-item" href="https://pmt.pi.gov.br/secretarios/">Órgãos da Prefeitura</a><a class="br-item" href="https://pmt.pi.gov.br/teresinensedigital/">Acesso à Informação</a><a class="br-item" href="http://legislacao.teresina.pi.gov.br/legislacao.php">Legislação</a><a class="br-item" href="http://ouvidoria.teresina.pi.gov.br/">Contato</a>
            </div>
          </div><span class="br-divider vertical mx-half mx-sm-1"></span>
          <div class="header-functions dropdown">
            <button class="br-button circle small" type="button" data-toggle="dropdown" aria-label="Abrir Funcionalidades do Sistema"><i class="fas fa-th" aria-hidden="true"></i>
            </button>
            <div class="br-list">
              <div class="header">
                <div class="title">Funcionalidades do Sistema</div>
              </div>
              <div class="br-item">
                <button class="br-button circle small" type="button" aria-label="Funcionalidade 1"><i class="fas fa-chart-bar" aria-hidden="true"></i><span class="text">Funcionalidade 1</span>
                </button>
              </div>
              <div class="br-item">
                <button class="br-button circle small" type="button" aria-label="Funcionalidade 2"><i class="fas fa-headset" aria-hidden="true"></i><span class="text">Funcionalidade 2</span>
                </button>
              </div>
              <div class="br-item">
                <button class="br-button circle small" type="button" aria-label="Funcionalidade 3"><i class="fas fa-comment" aria-hidden="true"></i><span class="text">Funcionalidade 3</span>
                </button>
              </div>
              <div class="br-item">
                <button class="br-button circle small" type="button" aria-label="Funcionalidade 4"><i class="fas fa-adjust" aria-hidden="true"></i><span class="text">Funcionalidade 4</span>
                </button>
              </div>
            </div>
          </div>
          <div class="header-search-trigger">
            <button class="br-button circle" type="button" aria-label="Abrir Busca" data-toggle="search" data-target=".header-search"><i class="fas fa-search" aria-hidden="true"></i>
            </button>
          </div>

        </div>
      </div>
      <div class="header-bottom">
        <div class="header-menu">
          <div class="header-menu-trigger" id="header-navigation">
            <button class="br-button small circle" type="button" aria-label="Menu" data-toggle="menu" data-target="#main-navigation" id="navigation"><i class="fas fa-bars" aria-hidden="true"></i>
            </button>
          </div>
          <div class="header-info">
            <div class="header-title">Plantão Funerário</div>
          </div>
        </div>
        <div class="header-search" id="main-searchbox">
          <div class="br-input has-icon">
            <label for="searchbox">Texto da pesquisa</label>
            <input id="searchbox" type="text" placeholder="O que você procura?"/>
            <button class="br-button circle small" type="button" aria-label="Pesquisar"><i class="fas fa-search" aria-hidden="true"></i>
            </button>
          </div>
          <button class="br-button circle search-close ml-1" type="button" aria-label="Fechar Busca" data-dismiss="search"><i class="fas fa-times" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </div>
  </header>
  <main class="d-flex flex-fill mb-5" id="main">
    <div class="container-lg d-flex">
      <div class="row">
        <div class="br-menu" id="main-navigation">
          <div class="menu-container">
            <div class="menu-panel">
              <div class="menu-header">
                <div class="menu-title">
                  <img class="brasaoImg" src="" alt="Imagem ilustrativa"/>
                  <span style="font-size: 20px;">Usuário Interno</span>
                </div>
                <div class="menu-close">
                  <button class="br-button circle" type="button" aria-label="Fechar o menu" data-dismiss="menu"><i class="fas fa-times" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
              <nav class="menu-body" role="tree">
                <div class="menu-folder"><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Cadastro</span></a>
                  <ul>
                    <li><a class="menu-item" href="cadastro.html" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Novo Processo</span></a></li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Atualizar Processo</span></a></li>
                    <li><a class="menu-item" href="consulta.html" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Verificar Processo</span></a></li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Apagar Processo</span></a></li>
                  </ul>
                </div>

                <div class="menu-folder"><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Documentos</span></a>
                  <ul>
                    <li><a class="menu-item" href="CombinarTabelas.html" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Combinar Tabelas</span></a></li>
                    <li><a class="menu-item" href="../GeracaoArquivos/GuiaDeSepultamento.html" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Guia de Sepultamento</span></a></li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Relatório FMS</span></a>
                      <ul>
                        <li><a class="menu-item" href="../GeracaoArquivos/RelatorioFMS.html" role="treeitem"><span class="content">Relatório FMS Diário</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório FMS Semanal</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório FMS Mensal</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório FMS Anual</span></a></li>
                        <li><a class="menu-item" href="gerarRelatorioFMStabelas.html" role="treeitem"><span class="content">Relatório FMS (Por Tabela)</span></a></li>
                      </ul>
                    </li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Relatório Completo</span></a>
                      <ul>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório Completo Diário</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório Completo Semanal</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório Completo Mensal</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Relatório Completo Anual</span></a></li>
                      </ul>
                    </li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Tabela DATM</span></a></li>
                  </ul>
                </div>
                <div class="menu-folder"><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Ações</span></a>
                  <ul>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-heart" aria-hidden="true"></i></span><span class="content">sdfasfsdf</span></a></li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Serviços</span></a>
                      <ul>
                        <li><a class="menu-item" href="https://sei.pmt.pi.gov.br/sei/modulos/pesquisa/md_pesq_processo_pesquisar.php?acao_externa=protocolo_pesquisar&acao_origem_externa=protocolo_pesquisar&id_orgao_acesso_externo=0" role="treeitem"><span class="icon"><i class="fas fa-book" aria-hidden="true"></i></span><span class="content">Consulta de Processo</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-book" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-tree" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-tree" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                      </ul>
                    </li>
                    <li><a class="menu-item" href="javascript: void(0)"><span class="icon"><i class="fas fa-archive" aria-hidden="true"></i></span><span class="content">Camada 2</span></a></li>
                  </ul>
                </div>

                <div class="menu-folder"><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Institucional</span></a>
                  <ul>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-heart" aria-hidden="true"></i></span><span class="content">Camada 2</span></a></li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Camada 2</span></a>
                      <ul>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-book" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-tree" aria-hidden="true"></i></span><span class="content">Camada 3</span></a>
                          <ul>
                            <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Camada 4</span></a></li>
                            <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Camada 4</span></a></li>
                            <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="content">Camada 4</span></a></li>
                          </ul>
                        </li>
                        <li><a class="menu-item" href="javascript: void(0)"><span class="icon"><i class="fas fa-moon" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                      </ul>
                    </li>
                    <li><a class="menu-item" href="javascript: void(0)"><span class="icon"><i class="fas fa-archive" aria-hidden="true"></i></span><span class="content">Camada 2</span></a></li>
                  </ul>
                </div>

                <div class="menu-folder"><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Transparência</span></a>
                  <ul>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-heart" aria-hidden="true"></i></span><span class="content">Camada 2</span></a></li>
                    <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-address-book" aria-hidden="true"></i></span><span class="content">Camada 2</span></a>
                      <ul>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-book" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-tree" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                        <li><a class="menu-item" href="javascript: void(0)" role="treeitem"><span class="icon"><i class="fas fa-tree" aria-hidden="true"></i></span><span class="content">Camada 3</span></a></li>
                      </ul>
                    </li>
                    <li><a class="menu-item" href="javascript: void(0)"><span class="icon"><i class="fas fa-archive" aria-hidden="true"></i></span><span class="content">Camada 2</span></a></li>
                  </ul>
                </div>
                <a class="menu-item divider" href="FAQ.html" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Sobre</span></a>
                <a class="menu-item divider" href="https://prodater.pmt.pi.gov.br/sei/" role="treeitem"><span class="icon"><i class="fas fa-bell" aria-hidden="true"></i></span><span class="content">Acesso ao SEI!</span></a>
              </nav>

              <div class="menu-footer">
                <div>

                  <button class="br-sign-in" type="button" id="avatar-dropdown-trigger" data-toggle="dropdown" data-target="avatar-menu" aria-label="Olá, Fulano"><span class="br-avatar" title="Fulano da Silva"><span class="content bg-orange-vivid-30 text-pure-0">D</span></span><span class="ml-2 text-gray-80 text-weight-regular">Olá, <span class="text-weight-semi-bold">Fulano</span></span><i class="fas fa-caret-down" aria-hidden="true"></i>
                  </button>
                  <div class="br-list" id="avatar-menu" hidden="hidden" role="menu" aria-labelledby="avatar-dropdown-trigger"><a class="br-item" href="javascript:void(0)" role="menuitem">Dados pessoais</a><a class="br-item" href="javascript:void(0)" role="menuitem">Privacidade</a><a class="br-item" href="javascript:void(0)" role="menuitem">Notificações</a><a class="br-item" href="javascript:void(0)" role="menuitem">Perguntas frequentes</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="menu-scrim" data-dismiss="menu" tabindex="0"></div>
          </div>
        </div>

        <div class="col mb-5">
          <nav class="br-breadcrumb">
            <ol class="crumb-list" role="list">
              <li class="crumb home"><a class="br-button circle" href="home.html"><span class="sr-only">Página inicial</span><i class="fas fa-home"></i></a></li>
              <li class="crumb"><i class="icon fas fa-chevron-right"></i><a href="javascript:void(0)">Documentos</a>
              </li>
              <li class="crumb"><i class="icon fas fa-chevron-right"></i>Combinar Tabelas</li>
            </ol>
          </nav>
          <div class="main-content pl-sm-3 mt-4" id="main-content">
            <h1>Gerar Relatório FMS (por tabela)</h1>
            <p>Esta funcionalidade é utilizada para gerar o relatório da FMS a partir de tabelas salvas no computador.</p>
            <div class="row">
              <div class="col-md-6">
                <div class="br-upload">
                  <label class="upload-label" for="fms-excel-upload"><span>Selecione o arquivo Excel de tabelas</span></label>
                  <input class="upload-input" id="fms-excel-upload" type="file" accept=".xlsx, .xls" aria-label="enviar arquivo Excel"/>
                  <div class="upload-list"></div>
                </div>
                <button class="br-button secondary mt-3" type="button" id="retornarFMS">Voltar
                </button>
                <button id="gerar-relatorio-fms-tabelas" class="br-button primary mt-3">Gerar Relatório FMS</button>
              </div>
            </div>
            <br><br><br><br><br><br><br>
            <h1>Gerar Relatório SDU-CENTRO (por tabela)</h1>
            <p>Esta funcionalidade é utilizada para gerar o relatório da SDU-CENTRO a partir de tabelas salvas no computador.</p>
            <div class="row">
              <div class="col-md-6">
                <div class="br-upload">
                  <label class="upload-label" for="sdu-excel-upload"><span>Selecione o arquivo Excel de tabelas</span></label>
                  <input class="upload-input" id="sdu-excel-upload" type="file" accept=".xlsx, .xls" aria-label="enviar arquivo Excel"/>
                  <div class="upload-list"></div>
                </div>
                <button class="br-button secondary mt-3" type="button" id="retornarSDU">Voltar
                </button>
                <button id="gerar-relatorio-sdu-tabelas" class="br-button primary mt-3">Gerar Relatório SDU-CENTRO</button>
              </div>
            </div>

          </div>
        </div>

      </div>
    </div>
  </main>
  <footer class="br-footer pt-3" id="footer">
    <div class="container-lg">
      <div class="info">
        <div class="text-down-01 text-medium pb-3">Todo o conteúdo deste site está publicado sob a licença&nbsp;<strong><a href="https://creativecommons.org/licenses/by-nd/3.0/deed.en">Creative Commons Atribuição-SemDerivações 3.0 Não Adaptada</a>.</strong></div>
      </div>
    </div>
  </footer>
</div>
<script defer src="https://cdn.jsdelivr.net/npm/@govbr-ds/core/dist/core.min.js"></script>
<script type="module">
  import { loadImageAsBase64,readExcelFile, gerarRelatorioFmsPDF, gerarRelatorioSduPDF } from '../GerarArquivos.js';

  // URL da imagem
  const PMTbrasaoUrl = "https://i.imgur.com/HaGCfsJ.png";

  // Carregar a imagem ao iniciar a página
  window.onload = async () => {
    const base64String = await loadImageAsBase64(PMTbrasaoUrl);
    if (base64String) {
      // Selecionar todos os elementos com a classe brasaoImg
      const images = document.getElementsByClassName('brasaoImg');
      for (let img of images) {
        img.src = base64String;
      }
    }
// Evento para gerar relatório FMS a partir de Excel
    const excelInput = document.getElementById('fms-excel-upload');
    const gerarFmsButton = document.getElementById('gerar-relatorio-fms-tabelas');
    if (excelInput && gerarFmsButton) {
      gerarFmsButton.addEventListener('click', async () => {
        const file = excelInput.files[0];
        if (!file) {
          alert("Por favor, selecione um arquivo Excel.");
          return;
        }
        const data = await readExcelFile(file);
        if (data) {
          try {
            await gerarRelatorioFmsPDF(data);
            alert("Relatório FMS gerado com sucesso!");
          } catch (error) {
            console.error("Erro ao gerar o relatório FMS:", error);
            alert("Ocorreu um erro ao gerar o relatório.");
          }
        }
      });
    } else {
      console.error("Elemento com ID 'fms-excel-upload' ou 'gerar-relatorio-fms' não encontrado no DOM.");
    }


    // Evento para o botão Voltar FMS
    const voltarButtonFMS = document.getElementById('retornarFMS');
    if (voltarButtonFMS) {
      voltarButtonFMS.addEventListener('click', () => {
        window.location.href = 'home.html';
      });
    } else {
      console.error("Elemento com ID 'retornarFMS' não encontrado no DOM.");
    }

    // Evento para gerar relatório SDU a partir de Excel
    const excelInputSDU = document.getElementById('sdu-excel-upload');
    const gerarSDUButton = document.getElementById('gerar-relatorio-sdu-tabelas');
    if (excelInputSDU && gerarSDUButton) {
      gerarSDUButton.addEventListener('click', async () => {
        const file = excelInputSDU.files[0];
        if (!file) {
          alert("Por favor, selecione um arquivo Excel.");
          return;
        }
        const data = await readExcelFile(file);
        if (data) {
          try {
            await gerarRelatorioSduPDF(data);
            alert("Relatório SDU-CENTRO gerado com sucesso!");
          } catch (error) {
            console.error("Erro ao gerar o relatório SDU-CENTRO:", error);
            alert("Ocorreu um erro ao gerar o relatório.");
          }
        }
      });
    } else {
      console.error("Elemento com ID 'sdu-excel-upload' ou 'gerar-relatorio-sdu' não encontrado no DOM.");
    }

    // Evento para o botão Voltar SDU
    const voltarButtonSDU = document.getElementById('retornarSDU');
    if (voltarButtonSDU) {
      voltarButtonSDU.addEventListener('click', () => {
        window.location.href = 'home.html';
      });
    } else {
      console.error("Elemento com ID 'retornarSDU' não encontrado no DOM.");
    }

  };
</script>

</body>
</html>
